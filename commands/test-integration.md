# 集成测试运行与修复

## 目标
运行项目的所有集成测试，验证模块间协作和外部依赖集成，修复失败的测试用例。

## 执行流程

### 1. 测试运行
- 定位项目的集成测试运行命令
- 确保测试环境和依赖就绪（数据库、API、文件系统等）
- 执行所有集成测试并收集结果
- 记录失败的测试用例和错误信息

### 2. 问题诊断
对每个失败的测试进行分析，区分问题类型：

**集成层面问题**：
- 模块间接口不匹配
- 数据传递和转换错误
- 依赖配置或初始化问题
- 事务和状态管理问题

**外部依赖问题**：
- 数据库连接或查询错误
- API调用失败或响应格式变化
- 文件系统权限或路径问题
- 第三方服务不可用

**测试设计问题**：
- 测试数据准备不充分
- 测试清理不完整导致状态污染
- 测试顺序依赖问题
- Mock/Stub配置不当

### 3. 修复策略
- **代码问题**: 修复模块接口或集成逻辑
- **环境问题**: 调整配置或设置测试环境
- **测试问题**: 优化测试数据管理和隔离性
- **依赖问题**: 更新mock策略或修复真实依赖

### 4. 验证与报告
- 修复后重新运行测试确保通过
- 验证测试隔离性（多次运行结果一致）
- 确保修复没有影响其他测试
- 输出测试结果摘要

## 成功标准
- 所有集成测试通过
- 测试具有良好的隔离性和可重复性
- 或者,对于合理的失败，提供清晰的问题报告和建议

## 输出格式
```markdown
## 集成测试执行结果

**测试总数**: X
**通过**: Y
**失败**: Z

### 已修复的问题
1. [测试名称] - [问题类型] - [修复说明]
...

### 环境配置调整（如有）
- [配置项] - [调整说明]
...

### 遗留问题（如有）
1. [测试名称] - [问题描述] - [建议方案]
...
```

## 约束条件
- 优先检查环境配置和依赖状态
- 确保测试数据的准备和清理机制健全
- 保持测试的独立性，避免测试间相互影响
- 对外部依赖使用合理的mock策略
- 集成测试应测试真实交互，避免过度mock
