# E2E测试运行与修复

## 目标
运行项目的所有端到端(E2E)测试，验证完整用户流程和系统集成，修复失败的测试用例。

## 执行流程

### 1. 测试运行
- 定位项目的E2E测试运行命令（如 Playwright、Cypress、Selenium等）
- 确保测试环境完整启动（应用服务、数据库、相关服务等）
- 执行所有E2E测试并收集结果
- 记录失败的测试用例、截图和错误日志

### 2. 问题诊断
对每个失败的测试进行分析，区分问题类型：

**应用层面问题**：
- 页面渲染或路由错误
- 用户交互逻辑问题
- 数据显示不正确
- API响应处理错误

**环境配置问题**：
- 测试服务未正确启动
- 数据库初始状态不正确
- 环境变量或配置缺失
- 网络或跨域问题

**测试稳定性问题**：
- 时序问题（元素未加载完成）
- 测试数据冲突或污染
- 异步操作等待不当
- 选择器失效或不稳定

**测试设计问题**：
- 测试步骤不符合实际用户行为
- 断言过于严格或不合理
- 测试场景覆盖不完整
- 测试数据准备不充分

### 3. 修复策略
- **应用问题**: 修复功能代码或UI组件
- **环境问题**: 调整测试环境配置和初始化流程
- **稳定性问题**: 优化等待策略、选择器和测试隔离
- **设计问题**: 重构测试用例使其更接近真实用户场景

### 4. 验证与报告
- 修复后重新运行测试确保通过
- 多次运行验证测试稳定性
- 检查测试执行时间，识别性能问题
- 输出测试结果摘要和失败截图分析

## 成功标准
- 所有E2E测试通过
- 测试运行稳定，无偶发性失败
- 测试覆盖核心用户流程
- 或者，对于合理的失败，提供清晰的问题报告和建议

## 输出格式
```markdown
## E2E测试执行结果

**测试总数**: X
**通过**: Y
**失败**: Z
**执行时间**: Xs

### 已修复的问题
1. [测试场景] - [问题类型] - [修复说明]
...

### 稳定性优化（如有）
- [优化项] - [改进说明]
...

### 遗留问题（如有）
1. [测试场景] - [问题描述] - [失败截图分析] - [建议方案]
...
```

## 约束条件
- 优先确保测试环境完整性和一致性
- 使用稳定的选择器策略（data-testid优于CSS选择器）
- 合理设置等待时间，平衡稳定性和执行效率
- 保持测试数据独立性，避免测试间相互影响
- E2E测试应模拟真实用户行为，覆盖核心业务流程
- 关注测试执行时间，过慢的测试需要优化
