---
description: 会话保存
---

# 会话保存

## 核心目标

保存当前会话的上下文、进度和待办任务到 `TODO.md`，便于 `/todo-doit` 自动执行。

**关键约束**：任务将由**低智能模型**执行，任务描述必须**完整自包含**。

---

## 任务描述格式（执行模型友好）

每个任务必须包含：
- **🏠 项目背景**：项目是什么、技术栈、当前状态
- **🎯 任务目标**：具体要达成什么（可验证）
- **📁 核心文件**：精确路径 + 操作类型
- **🔨 执行步骤**：3-5 步具体操作
- **✅ 完成标志**：客观可验证的标准

❌ 错误：`- [ ] 修复用户模块的 bug`

✅ 正确：
```
- [ ] 修复 Safari 隐私模式下登录后刷新被踢出
  - 🏠 React + TypeScript，localStorage 存储认证信息
  - 🎯 Safari 隐私模式下登录后刷新保持登录
  - 📁 `src/auth/token.ts:45` - [修改] localStorage fallback
  - 🔨 1. 读 token.ts 2. 添加 try-catch 3. fallback 到 sessionStorage 4. 运行测试
  - ✅ Safari 隐私模式下刷新保持登录
```

---

## 输出文件：TODO.md

```markdown
# TODO - [日期]

## 🏠 项目背景
- **技术栈**: [React + TypeScript / Flutter / ...]
- **整体目标**: [2-3 句话]

## 🎯 下一步行动
> 脚本将自动执行这个任务（必须完整自包含）

- [ ] [任务标题]
  - 🎯 [目标] / 📁 [文件] / 🔨 [步骤] / ✅ [完成标志]

## 当前进度
整体进度: X/Y | 当前阶段: [描述]

## 本次完成
- [x] [任务] - [时间戳]

## 待办任务
### 高优先级
- [ ] [任务]（含 🎯/📁/✅）
### 普通优先级
- [ ] [任务]

## 关键上下文
- 技术决策 / 遇到的问题 / 已尝试但失败的方案
```

---

## 编写原则

- **自动化友好**：格式标准化，便于脚本解析
- **下一步明确**：只写一个下一步（最优先的那个）
- **任务完整自包含**：执行模型无需推断
- **完成即停止**：所有任务完成时标记 `✅ 所有任务已完成`
