### Phase 0: 现状辛辣诊断 (Design Audit)

**"一个漂亮的灵魂，被困在了 OverflowBox 里。"**

1. **视觉层级与噪音 (Visual Hierarchy & Noise):**
* **iOS 主页:** 背景是高饱和度的蓝紫渐变，上面的卡片又是高饱和度的马卡龙色。这叫“双重高光争夺”。如果是多彩卡片，背景就需要后退（素净）；如果是氛围背景，卡片就需要通透（毛玻璃）。现在的感觉像是一个“糖果铺爆炸现场”，看久了眼睛会累。
* **文字对比度:** 在 `macos_settings_page` 中，“设置”标题漂浮在一片惨白中，层级太弱。


2. **割裂感 (Inconsistency - iOS vs macOS):**
* **人格分裂:** iOS 端看起来像个潮酷的音乐 App（渐变、深色），而 macOS 端看起来像个没有任何感情的后台管理系统（大片纯白、线性图标）。侧边栏（Sidebar）太原生了，缺乏“LT Music”该有的温度。


3. **工程落地 (Engineering & Layout):**
* **死亡黄条:** 我在 `macos_offline_page` 和 `ios_downloads_page` 看到了 `BOTTOM OVERFLOWED BY 1.00 PIXELS` 和 `25 PIXELS`。
* **诊断:** 这是典型的 Flutter 新手错误。你可能在一个固定高度的容器里用了 `Column`，却忘了加 `Expanded` 或 `ListView`；或者是底部导航栏（BottomBar）的高度计算没有包含 `SafeArea`。
* **间距:** 首页六宫格的间距（Gutter）看起来很随意，缺乏网格系统的严谨。


4. **伪物化的缺失 (The "Skeuomorphic" Promise):**
* 目前的 UI 主要是“扁平色块 + 淡淡的阴影”。要达到你想要的“温暖/拟物”，我们需要引入**内阴影 (Inner Shadow)**、**微渐变**和**更柔和的弥散光**，而不是简单的纯色填充。



---

### Phase 1: 视觉隐喻与重构策略 (Visual Concept)

**核心隐喻: "Ceramic & Diffused Light" (温润陶艺与漫射光)**

我们要从“扁平马卡龙”进化为“有触感的陶艺”。

* **氛围容器 (Atmosphere):**
* **iOS:** 放弃线性的蓝紫渐变，改用 **Mesh Gradient (网格弥散渐变)**。让颜色像呼吸一样缓慢流动，不要太抢戏。
* **macOS:** 保持干净，但加入一层暖色底色（`#FFFBF9`），侧边栏采用**磨砂玻璃 (Frosted Glass)** 效果，而不是死板的灰色色块，让它看起来通透。


* **色彩映射 (Color Mapping):**
* **主色调:** `Coral Orange` (#FF8FAB) 作为点睛之笔（播放按钮、进度条），传递“体温”。
* **卡片材质:** 不再是纯色背景。
* **旧:** 纯粉色/纯蓝色背景。
* **新:** **白釉色 (Off-White) 陶瓷质感**（90% 不透明度），上面叠加一层极淡的对应色光晕。这样更耐看。




* **光影 (Shadows):**
* **高级感:** 抛弃黑色阴影。使用**环境色阴影**。
* *Example:* `BoxShadow(color: Color(0xFFE2D6).withOpacity(0.4), blurRadius: 20, offset: Offset(0, 8))` —— 这种阴影看起来是“浮起来的”，而不是“贴上去的”。



---

### Phase 2: 关键组件视觉解构 (Critical Component Breakdown)

我们将重构最核心的 **首页六宫格** 和 **底部播放栏**。

#### 1. 功能卡片 (Function Grid Item)

*重构首页那 6 个彩色的方块。*

* **形态:** 超椭圆 (Squarcle)，圆角 `24.w`。
* **材质:**
* **底板:** 白色 (Surface Low)，带微弱的内发光。
* **图标容器:** 卡片内部悬浮一个彩色的圆形气泡（原本的卡片背景色缩为一个圆），图标放在圆里。
* **效果:** 这样既保留了色彩识别度，又让整体画面瞬间清爽 80%。


* **交互:** 点击时整体缩小至 0.96 (Scale Down)，配合触感反馈。

#### 2. 迷你播放条 (Mini Player)

*重构底部的播放控件。*

* **形态:**
* **iOS:** 悬浮胶囊 (Floating Capsule)，左右留出边距。
* **macOS:** 底部通栏 Dock。


* **材质:** **毛玻璃 (Glassmorphism)**。
* `BackdropFilter` (Blur 15px) + 白色半透明层 (Opacity 0.7)。
* 边框：1px 纯白细线 (Opacity 0.3)，模拟玻璃边缘的高光。


* **进度条:** 一条极细的暖橙色线条，吸附在播放条的最上沿。

#### 3. 头部连接状态 (Header Card)

* **问题:** 现在的“主线路”卡片像个横幅广告。
* **修正:** 做成一个“仪表盘小组件”。
* 左侧是脉冲式的绿点（呼吸灯），中间是文字，右侧用微型图表显示连接质量。



---

### Phase 3: Claude Code 执行指令 (The Master Prompt)

请将以下 Prompt 复制给你的 AI 工程师（Claude），让它直接产出重构后的代码。

```markdown
# Refactor Task: LT Music Home Page & Design System
# Role: Senior Flutter Engineer (UI Focus)

## Context
We are upgrading the "LT Music" Home Page from a flat prototype to a polished, warm, tactile UI.
We need to implement a responsive layout that handles the iOS Grid and the macOS Desktop view gracefully, fixing existing overflow bugs completely.

## Technical Stack
* **Framework**: Flutter (Latest Stable)
* **State Management**: `flutter_riverpod`
* **Responsiveness**: `flutter_screenutil` (for mobile scaling) + `LayoutBuilder` (for desktop adaptation).
* **Animations**: `flutter_animate` (for subtle entry effects).
* **Icons**: `lucide_icons` or `cupertino_icons`.

## Design Token Definition (The "Warmth" System)
Define a class `AppTheme` with these constants:
* **Colors**:
    * `background`: Color(0xFFFDFCFB) // Warm Off-white, avoiding pure clinical white
    * `primary`: Color(0xFFFF8FAB) // Coral/Salmon (Warmth accent)
    * `textPrimary`: Color(0xFF2D3436)
    * `textSecondary`: Color(0xFF636E72)
    * `surface`: Colors.white
* **Shadows**:
    * `softShadow`: `[BoxShadow(color: Color(0xFFD3C1B6).withOpacity(0.25), blurRadius: 24, offset: Offset(0, 12))]`
    * `glow`: `[BoxShadow(color: primary.withOpacity(0.3), blurRadius: 16, offset: Offset(0, 4))]`
* **Dimensions**:
    * `cardRadius`: 24.0
    * `gridGap`: 16.0

## Component Specs

### 1. The Home Grid (Refactored Visuals)
* **Layout Logic**:
    * Mobile: 2 Columns.
    * Desktop: Adaptive (3 or 4 columns based on width).
* **Visual Style (Ceramic Look)**:
    * **Container**: White background, `cardRadius`, `softShadow`.
    * **Content**: Instead of filling the whole card with color, place the Icon inside a **Colored Circle (Bubble)** centered or top-aligned.
    * **Text**: Label below the icon, `textPrimary`, font weight `w600`.
    * **Interaction**: Wrap each card in a `GestureDetector` that triggers a `ScaleTransition` (0.96) on tap.

### 2. The Mini Player (Floating Glass)
* **Visual**: Use `ClipRRect` with `BackdropFilter` (Blur 15) and `Colors.white.withOpacity(0.8)`. Add a faint white border.
* **Positioning (Fixing the Overflow)**:
    * Use a `Stack` for the `HomePage`.
    * Layer 1: `CustomScrollView` (Content). **CRITICAL**: Add `SliverPadding(bottom: 120)` to the end of the scroll view. This ensures the last grid items are not hidden behind the player.
    * Layer 2: `Positioned` (bottom: 0, left: 0, right: 0) for the Player.
    * **Safe Area**: Wrap the Player content in `SafeArea(top: false)`.

## Implementation Steps
1.  Create `AppTheme` and `AppColors`.
2.  Implement `NeumorphicCard` widget (The new card style).
3.  Rewrite `HomePage` using `CustomScrollView` + `SliverGrid`.
4.  Implement the `MiniPlayer` as a floating glass component.

## Output
Generate `home_page.dart` and `theme.dart`. Prioritize the "Ceramic" feel and the fix for the bottom scrolling overlap.

```

--