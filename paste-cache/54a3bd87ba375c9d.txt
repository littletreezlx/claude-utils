## 🛠 Feature Spec: 极简分组创建 (Group Creation - Standard Edition)

### 1. User Story (用户故事)

> **作为一个** 组织者/用户，
> **我想要** 以最快的速度创建一个新的分组，
> **以便于** 我能立即开始往里面添加选项，而不是被各种配置项打断思路。

### 2. Information Architecture & Logic (交互逻辑)

我们将采用 **"平台差异化 (Adaptive)"** 策略：Mac 端追求效率（键盘流），移动端追求拇指友好（触控流）。

#### 策略 A：桌面端 (macOS) —— "Ghost Row" (幽灵行内联模式)

*设计意图：模拟 Finder 或 Excel 的操作体验，无需弹窗，视线不离开列表。*

1. **Trigger**: 点击侧边栏 `+` 按钮
2. **Action**:
* 系统在列表**顶部**插入一行临时的“幽灵卡片”(Ghost Card)。
* UI 样式：半透明的 `GlassGroupCard`，处于 `isEditing` 状态。
* **Focus**: 光标自动聚焦在输入框。


3. **Input**: 用户输入 "中午吃什么"。
4. **Commit**:
* 按 `Enter`: 校验非空 -> 存入数据库 -> 替换为真实卡片 -> **自动选中该分组** (进入右侧详情页)。
* 按 `Esc`: 取消创建，幽灵行消失。
* *鼠标点击外部*: 视为确认保存（若名称非空）。



#### 策略 B：移动端 (Mobile) —— "Modal Bottom Sheet" (底部浮层)

*设计意图：在大屏手机上便于单手操作，明确的“开始”与“结束”感。*

1. **Trigger**: 点击底部导航栏或 FAB 的 `+`。
2. **Action**:
* 呼出半屏高度的底部浮层 (`showModalBottomSheet`)。
* 背景变暗，浮层采用 Warm Ceramic 主题色。
* **Focus**: 键盘自动弹起，聚焦输入框。


3. **Input**:
* 仅包含一个核心元素：**名称输入框**。
* 辅助元素：简单的“创建”按钮（当输入框为空时置灰/Disable）。


4. **Commit**:
* 点击软键盘上的 "Done/完成" 或浮层上的 "Create" 按钮。
* 浮层收起，列表滚动到新项目，伴随轻微震动反馈。



### 3. Data Model Updates (数据模型微调)

虽然UI上只展示“标准”，但为了代码的健壮性，建议保留枚举，但默认写死。

```dart
// 在 OptionGroup 中
enum SelectionMode {
  standard, // 默认：纯随机 (1/N 概率)
  // elimination, // 预留：抽完即止 (暂不开放 UI，代码预埋即可)
}

// 数据库字段
// @Default(SelectionMode.standard) SelectionMode mode,

```

### 4. UI States Definition (界面状态)

| 状态 | 桌面端 (Inline) | 移动端 (Bottom Sheet) |
| --- | --- | --- |
| **Initial** | 列表顶部出现一行空白行，光标闪烁 | 底部弹窗升起，输入框获取焦点 |
| **Typing** | 回车图标高亮，提示可确认 | 按钮从灰色变为主题色 (Warm Brown) |
| **Loading** | 输入框右侧出现微型 Spinner | 按钮文字变为 Loading 动画 |
| **Error** | 输入框边框变红并抖动 (Shake) | Toast 提示 "请输入分组名称" |
| **Success** | 变为普通列表项，高亮一下 | 弹窗关闭，列表自动刷新并选中 |

### 5. Edge Cases (边界情况处理)

* **空名称提交**：
* 禁止提交。Input 为空时，Enter 键无效或按钮不可点。


* **名称重复**：
* 不允许重复


* **连续创建**：
* *Desktop*: 按下 Enter 保存后，如果用户紧接着又按 `Cmd+N`，立即再生成一行。
* *Mobile*: 弹窗关闭。不支持连续创建（通常移动端用户一次只建一个）。



---

## 🗺 User Journey Map (用户旅程)

```mermaid
sequenceDiagram
    participant User
    participant UI_Mobile as 移动端 (Sheet)
    participant UI_Mac as 桌面端 (List)
    participant DB as Drift (本地库)

    Note over User: 场景：新建一个 "周末去哪儿" 分组

    alt 移动端流程
        User->>UI_Mobile: 点击 "+"
        UI_Mobile->>UI_Mobile: 弹出底部浮层 (Focus Input)
        User->>UI_Mobile: 输入 "周末去哪儿"
        User->>UI_Mobile: 点击 "创建"
        UI_Mobile->>DB: 写入数据 (Mode=Standard)
        UI_Mobile-->>User: 震动反馈 + 关闭浮层
    else 桌面端流程
        User->>UI_Mac: 按 Cmd+N
        UI_Mac->>UI_Mac: 列表首行插入 "编辑态卡片"
        User->>UI_Mac: 输入 "周末去哪儿"
        User->>UI_Mac: 按 Enter
        UI_Mac->>DB: 写入数据 (Mode=Standard)
        UI_Mac->>UI_Mac: 变为普通卡片 + 自动选中
    end

```

---

## 🎨 UI Design Specs (Warm Ceramic Style)

为了符合你的 **Warm Ceramic** 设计语言：

1. **移动端浮层 (Bottom Sheet)**:
* **Shape**: 顶部左右圆角 `24.r`。
* **Background**: 使用 `RadialGradient` (#FFFBF9 -> #FFF0E0)，保持陶瓷温润感。
* **Input**: 下划线样式 (`UnderlineInputBorder`)，颜色为深暖棕色，去掉了复杂的边框，保持干净。


2. **桌面端内联 (Inline Row)**:
* **Visual**: 看起来必须和现有的 `GlassGroupCard` **一模一样**。
* **Difference**: 只有当光标放上去时，背景稍微加深一点点 (`Colors.white.withOpacity(0.6)` -> `0.8`)，模拟“聚焦”感。



